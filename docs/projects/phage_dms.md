# Phage DMS: Mapping Viral Fitness Landscapes {.text-center}

## Project Goal {.text-center}
The primary goal of this project was to systematically investigate how genetic variations in bacteriophage T7 affect its ability to infect and thrive in different *E. coli* bacterial hosts. By creating and testing vast libraries of phage variants, we aimed to uncover crucial sequence-function relationships that dictate phage fitness.

![T7 Bacteriophage Structure](../../images/phage_dms/t7_phage_structure.png){: .centered-image style="max-width: 500px;" data-aos="zoom-in"}

*T7 Bacteriophage*  
{: .text-center }

## Approach: Deep Mutational Scanning (DMS)
We utilized Deep Mutational Scanning (DMS), a high-throughput method to assess the functional consequences of thousands of mutations simultaneously. This was applied to three key T7 phage genes:
*   **gp11:** A structural tail protein involved in genome delivery and host interaction.
*   **gp6.3:** An exonuclease essential for degrading host DNA.
*   **gp5.5:** A protein crucial for overcoming certain host defense mechanisms.

Each engineered mutation was linked to a unique DNA barcode. This barcoding strategy allowed us to pool all variants and track their relative abundance using next-generation sequencing.

### Experimental & Data Workflow
1.  **Library Construction:** Generated diverse libraries of phage T7, each variant carrying mutations in gp11, gp6.3, or gp5.5, and a unique barcode.
2.  **Selection Assays:** These phage libraries were then "passaged" (grown) on different *E. coli* host strains (10G, BW25113, BL21, O121) at a low multiplicity of infection (MOI ~0.01). This creates a selective pressure where fitter phages replicate more.
3.  **Sequencing (NextSeq):** The DNA barcodes from the phage populations were sequenced *before* (input pool) and *after* (output pool) growth on each host.
    ![Conceptual DNA Amplicons](../../images/phage_dms/dna_amplicon_concept.png)
    *Caption: Conceptual representation of barcoded DNA amplicons prepared for sequencing.*
4.  **Data Processing & Fitness Calculation:**
    *   Raw sequencing reads were processed to count the occurrences of each barcode.
    *   Fitness scores for each variant on each host were calculated by comparing its frequency in the output pool to the input pool (e.g., log2 fold change).

## Data Science Highlights & Challenges

### Managing Large-Scale Sequencing Data
A core data science component involved processing and analyzing the large datasets generated by NextSeq. This included developing pipelines for:
*   Accurate barcode identification and read counting.
*   Quality control, such as assessing the impact of ambiguous base calls ('N's) in reads.

![Distribution of 'N' Basepairs in Reads](../../images/phage_dms/n_basepair_distribution.png){: .centered-image style="max-width: 600px;" data-aos="zoom-in"}
*Caption: Analysis of uncertain base calls ('N's) in sequencing reads. While reads with 'N's in critical regions were a concern, their low overall frequency meant that excluding them had minimal impact on the final results, streamlining the analysis.*

### Quantifying and Visualizing Fitness Landscapes
The central analytical task was to transform barcode counts into interpretable fitness landscapes.
*   **Fitness Metrics:** Calculated relative fitness scores for tens of thousands of variants across multiple conditions.
*   **Visualization:** Developed various visualizations (e.g., heatmaps, scatter plots) to identify patterns of beneficial, deleterious, or host-specific mutations.

**Example: Amino Acid Substitutions and Host Specificity**
Data analysis revealed how specific amino acid changes at particular positions within a protein (e.g., gp11) impacted phage fitness differently depending on the bacterial host.

![Example Amino Acid Substitution Effects](../../images/phage_dms/aa_substitution_example.png){: .centered-image style="max-width: 200px;" data-aos="zoom-in"}
*Caption: Representative data showing how substituting the original amino acid at a specific position in gp11 (Y-axis: average log2 functional score) affects phage fitness across different E. coli hosts (X-axis or different colors). For example, a Proline (P) substitution might be generally disruptive. Conversely, changing an Alanine (A) to Cysteine (C) could be highly beneficial in the O121 host but neutral or deleterious in others. Such analyses pinpoint residues critical for host-specific interactions.*

Key insights from this type of analysis included:
*   Identifying mutations that confer a general fitness advantage or disadvantage.
*   Pinpointing "host-adaptive" mutations that enhance fitness in one host but might be neutral or detrimental in another. For example, the O121 host showed strong preferences for or against certain substitutions at specific sites.

## Structural Interpretation with PyMOL
To bridge the gap between sequence-level changes and their physical implications, fitness data was mapped onto the 3D structure of the gp11 protein using PyMOL. This allowed for the visualization of functional "hotspots."

![gp11 Enriched Hotspots](../../images/phage_dms/pymol_gp11_enriched_hotspots.png){: .centered-image style="max-width: 600px;" data-aos="zoom-in"}
*Caption: PyMOL visualization of gp11. Residues where mutations frequently led to *increased* phage fitness are highlighted (e.g., in red), indicating regions potentially involved in beneficial adaptations.*

![gp11 Intolerant Hotspots](../../images/phage_dms/pymol_gp11_intolerant_hotspots.png){: .centered-image style="max-width: 600px;" data-aos="zoom-in"}
*Caption: PyMOL visualization highlighting regions in gp11 (e.g., in blue) that are highly "intolerant" to mutations. Most changes at these sites were detrimental, suggesting they are critical for the protein's structural integrity or core function.*

![gp11 Host-Variant Hotspots](../../images/phage_dms/pymol_gp11_variant_hotspots.png){: .centered-image style="max-width: 600px;" data-aos="zoom-in"}
*Caption: PyMOL visualization showing "variant" hotspots â€“ positions where the functional outcome of mutations was highly dependent on the specific E. coli host. This points to regions directly involved in host-specific interactions.*

These structural analyses helped to:
*   Identify regions critical for gp11's stability and fundamental function.
*   Locate surface-exposed areas likely mediating interactions with host factors or other phage components (e.g., gp8, gp12).

## Project Summary & Impact
This project successfully combined high-throughput experimental methods (DMS) with robust data science techniques to:
*   Generate detailed fitness landscapes for key T7 phage proteins.
*   Identify specific mutations and protein regions that govern phage fitness and host specificity.
*   Provide valuable insights into the sequence-structure-function relationships within viral proteins.

The findings contribute to a deeper understanding of phage biology and have implications for phage engineering, potentially enabling the design of phages with tailored properties for therapeutic or biotechnological applications.
